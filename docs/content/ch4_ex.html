<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.30">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Exercices – Statistiques Fondamentales</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../content/ch5_0.html" rel="next">
<link href="../content/ch4_2.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-de070a7b0ab54f8780927367ac907214.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-83a5b8d58647c924f663c9ce3a35b344.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer",
    "search-label": "Recherche"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../utils/styles.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../content/ch4_ex.html">Exercices</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Recherche" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Statistiques Fondamentales</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/statsfonda/site" title="Code source" class="quarto-navigation-tool px-1" aria-label="Code source"><i class="bi bi-github"></i></a>
    <a href="../Statistiques-Fondamentales.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Recherche"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Organisation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Estimation de paramètre</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch2_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">La méthode des moments</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch2_ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercices</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Intervalles de confiance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch31_outils.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Outils pour les Intervalles de Confiance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch3_ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercices</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch4_0.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Test d’hypothèses</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch4_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Théorie des tests simples</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch4_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Tests du <span class="math inline">\(\chi_2\)</span></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch4_ex.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Exercices</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch5_0.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Moindres carrés</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch5_01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Modèles linéaires</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch5_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Outils gaussiens</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch5_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Tests linéaires</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch5_ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercices</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch6_0.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Modèles exponentiels</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch6_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Maximum de vraisemblance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch6_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">L’information de Fisher</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch6_ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercices</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch6_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Entropie et information</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch6_4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Principe d’entropie maximale</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/problemes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Problèmes et sujets</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch7_0.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Estimation de densité</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch7_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Test de Kolmogorov-Smirnov</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch7_ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercices</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch8_0.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Fisher VS Bayes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Et après ?</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ref.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Références</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/app1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Algèbre linéaire</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/app3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Formules d’inversion</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/app2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">50&nbsp;nuances de TCL</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table des matières</h2>
   
  <ul>
  <li><a href="#questions" id="toc-questions" class="nav-link active" data-scroll-target="#questions">Questions</a></li>
  <li><a href="#tests-élémentaires" id="toc-tests-élémentaires" class="nav-link" data-scroll-target="#tests-élémentaires">Tests élémentaires</a></li>
  <li><a href="#exercices" id="toc-exercices" class="nav-link" data-scroll-target="#exercices">Exercices</a></li>
  <li><a href="#travail-pratique1" id="toc-travail-pratique1" class="nav-link" data-scroll-target="#travail-pratique1">Travail pratique[^1]</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">
<div style="display:&nbsp;none;"><p style="display: none;">
$$
\newcommand{\bx}{\boldsymbol{x}}
\newcommand{\bt}{\boldsymbol{\theta}}
\newcommand{\bmu}{\boldsymbol{\mu}}
\newcommand{\dkl}{\mathrm{d}_{\mathrm{KL}}}
\newcommand{\dtv}{\mathrm{d}_{\mathrm{TV}}}
\newcommand{\emv}{\hat{\theta}_{\mathrm{emv}}}
\newcommand{\ent}{\mathrm{Ent}}
$$
</p></div>


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Exercices</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="questions" class="level2">
<h2 class="anchored" data-anchor-id="questions">Questions</h2>
<ul>
<li>Quelles sont les erreurs du test consistant à toujours accepter l’hypothèse nulle ?</li>
<li>Quelles sont les erreurs du test consistant à toujours refuser l’hypothèse nulle ?</li>
<li>Montrer que la distance en variation totale entre deux mesures de densités <span class="math inline">\(p,q\)</span> peut aussi s’écrire <span class="math inline">\(\int(p/q-1)_+ \mathrm{d}p\)</span>.</li>
<li>Montrer que si <span class="math inline">\(\mathrm{d}_{\mathrm{KL}}(P_n \mid Q) \to 0\)</span>, alors <span class="math inline">\(P_n\)</span> converge en loi vers <span class="math inline">\(Q\)</span>.</li>
<li>Calculer la distance en variation totale entre deux lois de Bernoulli de paramètres respectifs <span class="math inline">\(p\)</span> et <span class="math inline">\(q\)</span>.</li>
<li>Calculer la distance en variation totale entre une loi <span class="math inline">\(\mathrm{Bin}(n,p)\)</span> et une loi <span class="math inline">\(N(\mu,\sigma^2)\)</span>.</li>
<li>Soient <span class="math inline">\(P,Q\)</span> deux mesures distinctes. Montrer que <span class="math inline">\(\dtv(P^{\otimes n}, Q^{\otimes n})\)</span> tend vers 1.</li>
<li>Soient <span class="math inline">\(P,Q\)</span> deux mesures. Montrer que <span class="math inline">\(\dkl(P^{\otimes n} \mid Q^{\otimes n}) = n \dkl(P \mid Q)\)</span>.</li>
</ul>
</section>
<section id="tests-élémentaires" class="level2">
<h2 class="anchored" data-anchor-id="tests-élémentaires">Tests élémentaires</h2>
<p>Pour tous les cas suivants, il faut savoir réaliser rapidement un test puissant, voire même optimal au sens qu’il vous plaira.</p>
<ul>
<li>Tester <span class="math inline">\(\mu = \mu_0\)</span> contre <span class="math inline">\(\mu = \mu_1\)</span> dans un échantillon <span class="math inline">\(N(\mu, \sigma^2)\)</span> lorsque <span class="math inline">\(\sigma\)</span> est connu.</li>
<li>Même question lorsque <span class="math inline">\(\sigma\)</span> est inconnu (attention :&nbsp;dans ce cas les hypothèses ne sont pas simples mais composites. Il faut utiliser le rapport des maximums de vraisemblance, que l’on verra plus tard).</li>
<li>Soient <span class="math inline">\(X_1, \dotsc, X_n\)</span> un échantillon iid <span class="math inline">\(N(\mu_1,\sigma_1^2)\)</span> et <span class="math inline">\(Y_1, \dotsc, Y_m\)</span> (<span class="math inline">\(m\)</span> et <span class="math inline">\(n\)</span> ne sont pas forcément égaux) un échantillon iid de loi <span class="math inline">\(N(\mu_2,\sigma_2^2)\)</span>. Tester <span class="math inline">\(\sigma_1 = \sigma_2\)</span> lorsque <span class="math inline">\(\mu_1\)</span> et <span class="math inline">\(\mu_2\)</span> sont connues.</li>
<li>Même question lorsque <span class="math inline">\(\mu_1\)</span> et <span class="math inline">\(\mu_2\)</span> ne sont pas connues (même remarque que précédemment).<br>
</li>
<li>Donner la forme d’un test sur la valeur de <span class="math inline">\(p\)</span> pour une réalisation d’une loi <span class="math inline">\(\mathrm{Bin}(n,p)\)</span> et calculer son niveau asymptotique quand <span class="math inline">\(n\to\infty\)</span>.</li>
<li>Donner la forme d’un test sur la valeur de <span class="math inline">\(\lambda\)</span> dans un échantillon de <span class="math inline">\(n\)</span> variables aléatoires de Poisson de paramètre <span class="math inline">\(\lambda\)</span>.</li>
</ul>
</section>
<section id="exercices" class="level2">
<h2 class="anchored" data-anchor-id="exercices">Exercices</h2>
<div id="exr-testchideux" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 1</strong></span> Soient <span class="math inline">\(X_1, \dotsc, X_n\)</span> des variables indépendantes de loi <span class="math inline">\(\chi_2(p)\)</span>. On cherche à tester l’hypothèse nulle <span class="math inline">\(p=1\)</span> contre l’hypothèse alternative <span class="math inline">\(p=2\)</span>.</p>
<ol type="1">
<li>Écrire la forme de la région de rejet des tests de rapport de vraisemblance.</li>
<li>Essayer de calculer le niveau de ce test ; si ce n’est pas possible, essayer de le borner.</li>
</ol>
</div>
<div id="exr-testvar" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 2</strong></span> Soient <span class="math inline">\(X_1, \dotsc, X_n\)</span> des variables indépendantes de loi <span class="math inline">\(N(0,\sigma^2)\)</span>. Proposer un test de niveau <span class="math inline">\(\alpha\)</span> de l’hypothèse <span class="math inline">\(\sigma^2=1\)</span> contre l’hypothèse <span class="math inline">\(\sigma^2 = 1+\varepsilon\)</span>, et estimer sa puissance. Comment varie-t-elle en fonction de <span class="math inline">\(n\)</span> et de <span class="math inline">\(\varepsilon\)</span> ?</p>
</div>
<div id="exr-testrandom" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 3</strong></span> Soient <span class="math inline">\(X_1, \dotsc, X_n\)</span> des variables indépendantes de même loi <span class="math inline">\(P\)</span>. On cherche à tester l’hypothèse nulle <span class="math inline">\(P = N(0,1)\)</span> contre l’hypothèse alternative <span class="math inline">\(P = \mathscr{T}(n)\)</span>.</p>
<ol type="1">
<li>Donner le test optimal au sens de l’affinité.</li>
<li>Donner un autre test, de niveau <span class="math inline">\(1-\alpha\)</span>, et calculer sa puissance.</li>
<li>Comparer ces deux tests, en particulier dans le régime où <span class="math inline">\(n\)</span> est grand.</li>
</ol>
</div>
<div id="exr-samplecomplexity" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 4</strong></span> Montrer que le nombre de lancers nécessaire pour distinguer une pièce équilibrée <span class="math inline">\((p=1/2)\)</span> d’une pièce légèrement déséquilibrée (<span class="math inline">\(p_1 = 1/2 + \varepsilon\)</span>) est d’ordre <span class="math inline">\(1/\varepsilon^2\)</span>.</p>
</div>
<div id="exr-bintest" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 5</strong></span> On note <span class="math inline">\(p\)</span> la probabilité qu’un enfant né vivant soit un garçon. On suppose que les enfants sont de sexe indépendants, et que cette probabilité est la même pour toutes les grossesses.</p>
<ol type="1">
<li>Il y a eu en France métropolitaine en 2015 <span class="math inline">\(n=760\,421\)</span> naissances. , dont <span class="math inline">\(389\,181\)</span> garçons. Tester l’hypothèse <span class="math inline">\(p=\frac12\)</span> contre l’alternative pertinente.</li>
<li>En 1920, il y a eu <span class="math inline">\(838\,137\)</span> naissances dont <span class="math inline">\(432\,044\)</span> garçons. Tester l’hypothèse <span class="math inline">\(p_{2015}=p_{1920}\)</span>.</li>
</ol>
</div>
<div id="exr-testsdivers" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 6</strong></span> Soient <span class="math inline">\(X_1, \dotsc, X_n\)</span> i.i.d de loi <span class="math inline">\(N(\theta,1)\)</span>, où <span class="math inline">\(\theta\)</span> est un paramètre réel.</p>
<ol type="1">
<li>Donner un intervalle de confiance pour <span class="math inline">\(\theta\)</span> au niveau de risque <span class="math inline">\(5\%\)</span> de la forme <span class="math inline">\([\hat{\theta}_n, +\infty[\)</span>.</li>
<li>En déduire un test de niveau <span class="math inline">\(5\%\)</span> pour les hypothèses <span class="math inline">\(H_0: \theta = 0\)</span> et <span class="math inline">\(H_1: \theta &gt;0\)</span>.</li>
<li>Donner le modèle de l’expérience statistique. Donner l’expression du test de rapport de vraisemblance <span class="math inline">\(T\)</span> pour les hypothèses <span class="math inline">\(H_0: \theta =0\)</span> et <span class="math inline">\(H_1: \theta = \mu\)</span>, où <span class="math inline">\(\mu &gt;0\)</span>. Quel test retrouve-t-on?</li>
<li>Construire le test de rapport de vraisemblance au niveau <span class="math inline">\(5\%\)</span> pour les hypothèses <span class="math inline">\(H_0: \theta = 0\)</span> et <span class="math inline">\(H_1: \theta &gt;0\)</span>.</li>
</ol>
</div>
<div id="exr-testunif" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 7 (Test sur des lois uniformes)</strong></span> On se donne <span class="math inline">\(X_1, \dots, X_n\)</span> iid de loi <span class="math inline">\(\mathscr{U}(0,\theta)\)</span>, et on note <span class="math inline">\(M_n = \max_{j=1, \dots, n} X_i\)</span>.</p>
<ol type="1">
<li>Écrire la fonction de répartition de <span class="math inline">\(M_n\)</span>, puis en déduire un test <span class="math inline">\(T\)</span> de niveau <span class="math inline">\(1-\alpha\)</span> pour les hypothèses <span class="math inline">\(H_0: \theta = 1\)</span> contre <span class="math inline">\(H_1: \theta &lt; 1\)</span>.</li>
<li>Donner le test du rapport de vraisemblance pour pour les hypothèses <span class="math inline">\(H_0: \theta = 1\)</span> contre <span class="math inline">\(H_1: \theta = \theta_0\)</span>, où <span class="math inline">\(\theta_0&lt;1\)</span>. Calculer sa puissance.</li>
<li>On cherche à tester <span class="math inline">\(H_0: \theta = 1\)</span> contre <span class="math inline">\(H_1: \theta &lt; 1\)</span>. Comme la seconde hypothèse est composite, on ne peut pas directement appliquer le test du rapport de vraisemblance ; à la place, on utilise un test du <em>maximum</em> de vraisemblance, qui est de la forme <span class="math display">\[ \frac{\sup_{\theta &lt; 1}\rho_\theta(x_1, \dotsc, x_n)}{\rho_1(x_1, \dotsc, x_n)} &gt; z\]</span> où <span class="math inline">\(\rho_\theta\)</span> est la densité d’un échantillon iid de lois <span class="math inline">\(\mathscr{U}[0,\theta]\)</span>. Calculer le supremum dans cette expression, et en déduire la région de rejet.</li>
<li>Montrer que la puissance de <span class="math inline">\(T\)</span> vaut <span class="math inline">\(\alpha\)</span>.</li>
<li>En utilisant la même technique, construire le test du rapport de maximum de vraisemblance pour pour les hypothèses <span class="math inline">\(H_0: \theta = 1\)</span> contre <span class="math inline">\(H_1: \theta&gt;1\)</span>, noté <span class="math inline">\(T'\)</span>, au niveau <span class="math inline">\(1-\alpha\)</span>. Calculer sa puissance.</li>
<li>Donner un test de niveau <span class="math inline">\(1-\alpha\)</span> pour <span class="math inline">\(H_0: \theta = 1\)</span> contre <span class="math inline">\(H_1: \theta&gt;1\)</span>, plus puissant que <span class="math inline">\(T'\)</span> pour n’importe quel <span class="math inline">\(\theta &gt;1\)</span>.</li>
</ol>
</div>
<div id="exr-binomtest" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 8</strong></span> Une réalisation d’une variable aléatoire <span class="math inline">\(X \sim \mathrm{Bin}(20,p)\)</span> donne <span class="math inline">\(X = 8\)</span>.</p>
<ol type="1">
<li>Proposer un test du rapport de vraisemblance de l’hypothèse nulle <span class="math inline">\(p=p_0=1/2\)</span> contre l’hypothèse alternative <span class="math inline">\(p=p_1=1/3\)</span>. Donner l’expression de la <span class="math inline">\(p\)</span>-valeur du test.</li>
<li>On tire des variables aléatoires iid de Bernoulli jusqu’à obtenir 8 succès. Écrire la loi de probabilité du nombre de lancers <span class="math inline">\(N\)</span>.</li>
<li>Il se trouve que le nombre de lancers nécessaires pour cela était <span class="math inline">\(N=20\)</span>. Proposer un test du rapport de vraisemblance de l’hypothèse nulle <span class="math inline">\(p=p_0=1/2\)</span> contre l’hypothèse alternative <span class="math inline">\(p=p_1=1/3\)</span>. Donner l’expression de la <span class="math inline">\(p\)</span>-valeur du test.</li>
<li>Pourquoi les deux <span class="math inline">\(p\)</span>-valeurs sont-elles différentes, alors que les deux tests sont identiques ?</li>
</ol>
</div>
<div id="exr-testdé" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 9 (Test d’adéquation du <span class="math inline">\(\chi_2\)</span>)</strong></span> On lance <span class="math inline">\(60\)</span> fois un dé et on obtient les résultats suivants :</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><strong>Face <span class="math inline">\(k\)</span></strong></th>
<th style="text-align: center;">1</th>
<th style="text-align: center;">2</th>
<th style="text-align: center;">3</th>
<th style="text-align: center;">4</th>
<th style="text-align: center;">5</th>
<th style="text-align: center;">6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Effectif <span class="math inline">\(N_k\)</span></strong></td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">13</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">8</td>
</tr>
</tbody>
</table>
<p>Le dé est-il bien équilibré ? À titre indicatif, le quantile d’une loi <span class="math inline">\(\chi^2(5)\)</span> d’ordre <span class="math inline">\(95\%\)</span> est <span class="math inline">\(11.07\)</span>.</p>
</div>
<div id="exr-testind" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 10 (Test d’indépendance du <span class="math inline">\(\chi_2\)</span>)</strong></span> On cherche à savoir si les variables « être riche » et « être heureux » sont indépendantes. On interroge un grand échantillon de personnes à ce sujet, et l’on récolte les données suivantes :</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th>riche</th>
<th>pauvre</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>heureux</strong></td>
<td>344</td>
<td>700</td>
<td></td>
</tr>
<tr class="even">
<td><strong>triste</strong></td>
<td>257</td>
<td>705</td>
<td></td>
</tr>
</tbody>
</table>
<p>L’argent fait-il le bonheur ?</p>
</div>
<div id="exr-testsmultiples" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 11 (Tests multiples (examen 24))</strong></span> Soient <span class="math inline">\(x_1, \dotsc, x_n\)</span> des variables aléatoires indépendantes gaussiennes dans <span class="math inline">\(\mathbb{R}^d\)</span>, de lois respectives <span class="math inline">\(N(\mu_i, \sigma_i^2 I_d)\)</span>, où <span class="math inline">\(\mu_i \in \mathbb{R}^d\)</span> et <span class="math inline">\(\sigma_i^2 &gt; 0\)</span> sont inconnus. On note <span class="math inline">\(H_{0,i}\)</span> l’hypothèse « <span class="math inline">\(\mu_i = 0\)</span> ».</p>
<ol type="1">
<li>Construire un test de <span class="math inline">\(H_{0,i}\)</span> de niveau de confiance <span class="math inline">\(1-\alpha\)</span>. On le notera <span class="math inline">\(T_{\alpha}^{(i)}\)</span>.</li>
<li>On effectue chacun des tests <span class="math inline">\(T^{(i)}_\alpha\)</span>, indépendamment les uns des autres. Si tous les <span class="math inline">\(\mu_i\)</span> sont simultanément nuls, quelle est la probabilité qu’aucune des hypothèses <span class="math inline">\(H_{0,i}\)</span> ne soit rejetée ? Quelle est la limite de cette probabilité lorsque <span class="math inline">\(n \to \infty\)</span> ?</li>
<li>Dorénavant, on notera <span class="math inline">\(H_0\)</span> l’hypothèse selon laquelle tous les <span class="math inline">\(\mu_i\)</span> sont nuls. Quel niveau de confiance <span class="math inline">\(1-\delta\)</span> faudrait-il choisir pour que, sous <span class="math inline">\(H_0\)</span>, la probabilité de l’événement « aucun des tests <span class="math inline">\(T^{(i)}_{\delta}\)</span> ne rejette <span class="math inline">\(H_{0,i}\)</span> » soit égale à <span class="math inline">\(1-\alpha\)</span> ?</li>
<li>On s’intéresse maintenant à la propriété suivante : « sous <span class="math inline">\(H_0\)</span>, la probabilité de l’événement “plus de <span class="math inline">\(k\%\)</span> des tests <span class="math inline">\(T^{(i)}_\delta\)</span> ont rejetés <span class="math inline">\(H_{0,i}\)</span>” est inférieure à <span class="math inline">\(\alpha\)</span> ».
<ol type="1">
<li>Sous <span class="math inline">\(H_0\)</span>, quelle est la loi du nombre d’hypothèses <span class="math inline">\(H_{0,i}\)</span> rejetées par <span class="math inline">\(T^{(i)}_{\delta}\)</span> ?</li>
<li>Trouver un <span class="math inline">\(\delta\)</span> (dépendant de <span class="math inline">\(k,\alpha,n\)</span>) tel que la famille de tests <span class="math inline">\(T_\delta^{(i)}\)</span> vérifie la propriété ci-dessus. (indice : Wassily).</li>
</ol></li>
</ol>
</div>
</section>
<section id="travail-pratique1" class="level1">
<h1>Travail pratique[^1]</h1>
<p>Faites un test du chi-deux (indépendance ou adéquation) de votre choix. Vous devez vous-même trouver une question qui vous intéresse. Cela peut être n’importe quoi :</p>
<ul>
<li>vérifier la loi de Benford dans je ne sais quel document ou site ou journal ;</li>
<li>se demander si le département de région d’une personne et ses opinions politiques sont indépendantes ;</li>
<li>tester une corrélation simple entre la météo à NY et la positivé du rendement du S&amp;P500 (« il pleut à Wall Street » vs « les marchés sont dans le vert ») ;&nbsp;</li>
<li>se demander si les naissances en France sont uniformément réparties sur les 365 jours de l’année ;</li>
<li>tester si ChatGPT ou je ne sais quel LLM&nbsp;est capable de générer des échantillons de lois précises (loi uniforme, loi de Poisson, etc). Je serai curieux d’avoir le résultat.</li>
<li>Etc.</li>
</ul>
<p>Trouvez donc une question intéressante, trouvez des données pertinentes (c’est peut-être la partie la moins simple), formulez la question sous la forme d’un test statistique, et réalisez le test avec votre langage de programmation favori (qui n’est pas R, soyez de bon goût). Écrivez quelques lignes pour me dire où vous avez eu les données et comment vous vous adaptez au formalisme du cours. Une page max (snippet de code compris) devrait suffire.</p>
<p>Pas besoin d’aller chercher très loin, un jeu de données simple suffit ! Amusez-vous bien.</p>
<p>Vous devez m’envoyer ça avant le 9 février 23h59, avec pour objet du mail votre nom suivi de “chi-deux”.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copié");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copié");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../content/ch4_2.html" class="pagination-link" aria-label="Tests du $\chi_2$">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Tests du <span class="math inline">\(\chi_2\)</span></span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../content/ch5_0.html" class="pagination-link" aria-label="Moindres carrés">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Moindres carrés</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>