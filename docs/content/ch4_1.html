<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.30">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>7&nbsp; Théorie des tests simples – Statistiques Fondamentales</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../content/ch4_2.html" rel="next">
<link href="../content/ch4_0.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-de070a7b0ab54f8780927367ac907214.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-83a5b8d58647c924f663c9ce3a35b344.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer",
    "search-label": "Recherche"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../utils/styles.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../content/ch4_1.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Théorie des tests simples</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Recherche" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Statistiques Fondamentales</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/statsfonda/site" title="Code source" class="quarto-navigation-tool px-1" aria-label="Code source"><i class="bi bi-github"></i></a>
    <a href="../Statistiques-Fondamentales.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Recherche"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Organisation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Estimation de paramètre</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch2_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">La méthode des moments</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch2_ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercices</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Intervalles de confiance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch31_outils.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Outils pour les Intervalles de Confiance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch3_ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercices</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch4_0.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Test d’hypothèses</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch4_1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Théorie des tests simples</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch4_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Tests du <span class="math inline">\(\chi_2\)</span></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch4_ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercices</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch5_0.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Moindres carrés</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch5_01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Modèles linéaires</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch5_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Outils gaussiens</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch5_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Tests linéaires</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch5_ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercices</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch6_0.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Modèles exponentiels</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch6_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Maximum de vraisemblance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch6_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">L’information de Fisher</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch6_ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercices</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch6_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Entropie et information</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch6_4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Principe d’entropie maximale</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/problemes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Problèmes et sujets</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch7_0.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Estimation de densité</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch7_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Test de Kolmogorov-Smirnov</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch7_ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercices</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch8_0.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Fisher VS Bayes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Et après ?</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ref.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Références</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/app1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Algèbre linéaire</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/app3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Formules d’inversion</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/app2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">50&nbsp;nuances de TCL</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table des matières</h2>
   
  <ul>
  <li><a href="#la-distance-en-variation-totale" id="toc-la-distance-en-variation-totale" class="nav-link active" data-scroll-target="#la-distance-en-variation-totale"><span class="header-section-number">7.1</span> La distance en variation totale</a></li>
  <li><a href="#test-optimal-au-sens-de-laffinité" id="toc-test-optimal-au-sens-de-laffinité" class="nav-link" data-scroll-target="#test-optimal-au-sens-de-laffinité"><span class="header-section-number">7.2</span> Test optimal au sens de l’affinité</a></li>
  <li><a href="#théorème-de-neyman-pearson" id="toc-théorème-de-neyman-pearson" class="nav-link" data-scroll-target="#théorème-de-neyman-pearson"><span class="header-section-number">7.3</span> Théorème de Neyman-Pearson</a></li>
  <li><a href="#un-exemple-de-test-de-rapport-de-vraisemblance" id="toc-un-exemple-de-test-de-rapport-de-vraisemblance" class="nav-link" data-scroll-target="#un-exemple-de-test-de-rapport-de-vraisemblance"><span class="header-section-number">7.4</span> Un exemple de test de rapport de vraisemblance</a></li>
  <li><a href="#variation-totale-et-distance-informationnelle" id="toc-variation-totale-et-distance-informationnelle" class="nav-link" data-scroll-target="#variation-totale-et-distance-informationnelle"><span class="header-section-number">7.5</span> Variation totale et distance informationnelle</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">
<div style="display:&nbsp;none;"><p style="display: none;">
$$
\newcommand{\bx}{\boldsymbol{x}}
\newcommand{\bt}{\boldsymbol{\theta}}
\newcommand{\bmu}{\boldsymbol{\mu}}
\newcommand{\dkl}{\mathrm{d}_{\mathrm{KL}}}
\newcommand{\dtv}{\mathrm{d}_{\mathrm{TV}}}
\newcommand{\emv}{\hat{\theta}_{\mathrm{emv}}}
\newcommand{\ent}{\mathrm{Ent}}
$$
</p></div>


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Théorie des tests simples</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="la-distance-en-variation-totale" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="la-distance-en-variation-totale"><span class="header-section-number">7.1</span> La distance en variation totale</h2>
<p>Lorsqu’on cherche à tester une hypothèse de type <span class="math inline">\(\text{loi} = P\)</span> contre une hypothèse de type <span class="math inline">\(\mathrm{loi} = Q\)</span> (c’est-à-dire, deux hypothèses simples), on en revient à chercher un événément très improbable sous la loi <span class="math inline">\(P\)</span>, et très probable sous la loi <span class="math inline">\(Q\)</span>. On peut se demander en toute généralité quels sont les événements pour lesquels ces probabilités diffèrent le plus, c’est-à-dire les événements <span class="math inline">\(A\)</span> qui maximisent <span class="math inline">\(P(A) - Q(A)\)</span>. Cela mène directement à la définition de la <em>variation totale</em>.</p>
<div id="def-dtv" class="theorem definition">
<p><span class="theorem-title"><strong>Définition 7.1 (distance en variation totale)</strong></span> Soient <span class="math inline">\(P,Q\)</span> deux mesures de probabilité sur un même espace <span class="math inline">\((\mathcal{X}, \mathscr{F})\)</span>. Leur distance en variation totale est <span class="math display">\[ \dtv(P,Q) = \sup_{A \in \mathscr{F}}P(A) - Q(A). \]</span></p>
</div>
<p>La distance en variation totale est un objet important en probabilités, qui possède de nombreuses propriétés. Parmi elles, voici les plus importantes.</p>
<ol type="1">
<li>C’est une distance sur l’espace des mesures de probabilité.</li>
<li>Elle génère une topologie plus fine que celle de la convergence en loi ;&nbsp;autrement dit, si <span class="math inline">\(\dtv(P_n, Q) \to 0\)</span> alors <span class="math inline">\(P_n\)</span> converge en loi vers <span class="math inline">\(Q\)</span> mais l’inverse n’est pas vrai.</li>
</ol>
<div id="prp-dtv" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 7.1</strong></span> Soit <span class="math inline">\(\nu\)</span> une mesure telle que <span class="math inline">\(P\)</span> et <span class="math inline">\(Q\)</span> sont absolument continues<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> par rapport à <span class="math inline">\(\nu\)</span>, de densités respectives <span class="math inline">\(p\)</span> et <span class="math inline">\(q\)</span> par rapport à <span class="math inline">\(\nu\)</span>. Alors, <span class="math inline">\(\dtv(P,Q)\)</span> est égale à chacune des quantités suivantes :</p>
<p><span class="math display">\[\int_{\mathcal{X}} (p(x) - q(x))_+\mathrm{d}\nu\]</span> <span id="eq-dtvformule"><span class="math display">\[ \frac{1}{2}\int_{\mathcal{X}} |p(x) - q(x)|\mathrm{d}\nu. \tag{7.1}\]</span></span></p>
<p>De plus, notons <span class="math inline">\(E\)</span> l’ensemble mesurable <span class="math inline">\(\{x \in \mathcal{X} : p(x)&gt;q(x)\}\)</span>. Alors, <span id="eq-dtv-2"><span class="math display">\[\dtv(P,Q) = P(E) - Q(E). \tag{7.2}\]</span></span></p>
</div>
<p>L’hypothèse selon laquelle <span class="math inline">\(P,Q\)</span> sont a.c. par rapport à <span class="math inline">\(\nu\)</span> est toujours vérifiée pour <span class="math inline">\(\nu = (P+Q)/2\)</span>, et n’est donc pas restrictive.</p>
<div class="proof">
<p><span class="proof-title"><em>Preuve</em>. </span>Pour tout événement <span class="math inline">\(A \in \mathscr{F}\)</span>, la différence <span class="math inline">\(P(A) - Q(A)\)</span> est égale à <span class="math inline">\(\int_A p(x) - q(x) \mathrm{d}\nu\)</span>, qui peut elle-même s’écrire sous la forme <span class="math display">\[\int_{A \cap E} (p - q) \mathrm{d}\nu + \int_{A \cap \bar{E}} (p - q) \mathrm{d}\nu.\]</span> Le second terme est négatif, puisque si <span class="math inline">\(x \notin E\)</span> alors <span class="math inline">\(p(x)\leqslant q(x)\)</span>. Ainsi, <span class="math inline">\(P(A) - Q(A)\)</span> est plus petit que le premier terme, lequel est à son tour plus petit que <span class="math inline">\(\int_E (p-q)d\nu = P(E) - Q(E)\)</span>. Cela montre directement <a href="#eq-dtv-2" class="quarto-xref">Équation&nbsp;<span>7.2</span></a>. Au passage, il est évident que <span class="math display">\[\int_E (p(x)-q(x))\mathrm{d}\nu = \int_{\mathcal{X}}(p(x) - q(x))_+ \mathrm{d}\nu,  \]</span> ce qui montre la première égalité de <a href="#eq-dtvformule" class="quarto-xref">Équation&nbsp;<span>7.1</span></a>. La seconde égalité résulte de la première, puisque comme <span class="math inline">\(p\)</span> et <span class="math inline">\(q\)</span> sont des densités de probabilité, on a forcément <span class="math inline">\(\int (p-q)_+ = \int(p-q)_-\)</span>.</p>
</div>
<p>Dans la suite, on supposera toujours que les diverses lois possèdent toutes une densité par rapport à une mesure de référence <span class="math inline">\(\nu\)</span>. C’est le cas dans de très nombreux modèles — pas tous, hélas. Les lettres majuscules désigneront les mesures, tandis que les lettres minuscules désigneront leurs densités.</p>
</section>
<section id="test-optimal-au-sens-de-laffinité" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="test-optimal-au-sens-de-laffinité"><span class="header-section-number">7.2</span> Test optimal au sens de l’affinité</h2>
<p>L’affinité d’un test est la somme de ses erreurs de première et seconde espèce :&nbsp;c’est la probabilité de « se tromper » en général, quelle que soit l’hypothèse.</p>
<div id="thm-affinity" class="theorem">
<p><span class="theorem-title"><strong>Théorème 7.1</strong></span> Soit <span class="math inline">\(\mathfrak{T}\)</span> l’ensemble des tests possibles de l’hypothèse <span class="math inline">\(H_0 :&nbsp;P = P_0\)</span> contre l’hypothèse alternative <span class="math inline">\(H_1 :&nbsp;P = P_1\)</span>. Alors, le test possédant la meilleure affinité possible parmi tous les tests possibles vérifie <span class="math display">\[\inf_{T \in \mathfrak{T}}~\{\alpha_T + \beta_T \} = 1 - \dtv(P_0, P_1). \]</span> En particulier, le test optimal pour l’affinité est donné par la région de rejet <span class="math display">\[ \mathsf{rejeter}_\star = \{p_0(x) &lt; p_1(x)\}.\]</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Preuve</em>. </span>Soit <span class="math inline">\(T\)</span> n’importe quel test. Son affinité est <span class="math inline">\(P_1(\{T=0\}) + P_0(\{T=1\})\)</span>. En passant au complémentaire dans le second terme, on obtient <span class="math display">\[1 - (P_0(\{T=0\}) - P_1(\{T=0\})). \]</span> Cette quantité est forcément plus petite que <span class="math inline">\(1 - \dtv(P_0, P_1)\)</span> par la définition même de la variation totale. De plus, cette borne est atteinte en choisissant le test <span class="math inline">\(T\)</span> donné dans l’énoncé, d’où l’égalité.</p>
</div>
<p><strong>Commentaire.</strong> Le théorème précédent semble donner au problème de la construction de tests une réponse définitive :&nbsp;il donne le test optimal au sens de l’affinité, test qui est élémentaire et intuitif. En effet, si <span class="math inline">\(P_0, P_1\)</span> sont les deux lois et si <span class="math inline">\((x_1, \dotsc, x_n)\)</span> est l’échantillon observé, alors on rejette l’hypothèse nulle si la probabilité de cette observation est plus grande sous <span class="math inline">\(P_1\)</span> que sous <span class="math inline">\(P_0\)</span> : autrement dit, si <span class="math display">\[ \frac{p_1(x_1, \dotsc, x_n)}{p_0(x_1, \dotsc, x_n)}&gt;1. \]</span> Le terme de droite s’appelle <strong>rapport de vraisemblance</strong>. Pourtant, ce test ne permet pas de contrôler l’erreur de première espèce. Il peut tout à fait exister d’autres tests qui ont un niveau plus élevé. Il est donc naturel de se demander si, parmi les tests ayant un niveau fixé <span class="math inline">\(1-\alpha\)</span>, il existe un autre critère d’optimalité.</p>
</section>
<section id="théorème-de-neyman-pearson" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="théorème-de-neyman-pearson"><span class="header-section-number">7.3</span> Théorème de Neyman-Pearson</h2>
<p>On se place toujours dans un cadre où les deux lois <span class="math inline">\(P_0\)</span> et <span class="math inline">\(P_1\)</span> possèdent deux densités <span class="math inline">\(p_0, p_1\)</span> par rapport à une mesure commune <span class="math inline">\(\nu\)</span>.</p>
<div id="def-testRV" class="theorem definition">
<p><span class="theorem-title"><strong>Définition 7.2</strong></span> Un <em>test du rapport de vraisemblance</em> est un test dont la région de rejet est de la forme <span id="eq-rejetMV"><span class="math display">\[\mathsf{rejeter}= \left\lbrace \frac{p_1(x)}{p_0(x)} &gt; z \right\rbrace  \tag{7.3}\]</span></span> pour un certain <span class="math inline">\(z&gt;0\)</span>.</p>
</div>
<p>Le test optimal au sens de l’affinité est un test de rapport de vraisemblance (<span class="math inline">\(z=1\)</span>).</p>
<div id="thm-jerzy" class="theorem">
<p><span class="theorem-title"><strong>Théorème 7.2 (Théorème de Neyman-Pearson)</strong></span> Tout test de même niveau qu’un test du rapport de vraisemblance est moins puissant que celui-ci.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Preuve</em>. </span>On suppose que la région de rejet de <span class="math inline">\(T_\star\)</span> est de la forme <a href="#eq-rejetMV" class="quarto-xref">Équation&nbsp;<span>7.3</span></a>. Soit <span class="math inline">\(T\)</span> un autre test de même niveau que <span class="math inline">\(T_\star\)</span>. La quantité <span class="math display">\[ \int_{\mathcal{X}} (T(x) - T_\star(x))(p_1(x) - z p_0(x))\mathrm{d}\nu \]</span> est forcément négative ou nulle : en effet, si <span class="math inline">\(T_\star(x)=1\)</span>, alors <span class="math inline">\(T(x)-T_\star(x) = T(x)-1 \leqslant 0\)</span>, mais <span class="math inline">\(p_1(x)\)</span> est plus grand que <span class="math inline">\(zp_0(x)\)</span>, donc <span class="math inline">\((p_1(x) - zp_0(x))\geqslant 0\)</span>. De même, si <span class="math inline">\(T(x) = 0\)</span>, alors cette fois ce terme est négatif. Dans les deux cas, la fonction dans l’intégrale est toujours le produit de deux nombres de signes opposés : elle est donc négative. Or, en développant cette intégrale, on constate qu’elle vaut aussi <span class="math display">\[P_1(T=1) - P_1(T_\star=1) - zP_0(T=1)+zP_0(T_\star=1). \]</span> Tout ceci n’est rien d’autre que <span class="math inline">\(\beta_\star-\beta - z(\alpha-\alpha_\star)\)</span>, où <span class="math inline">\(\alpha, \beta\)</span> désignent les deux types d’erreurs du test <span class="math inline">\(T\)</span> et <span class="math inline">\(\alpha_\star, \beta_\star\)</span> celles de <span class="math inline">\(T_\star\)</span>. Mais nous avons supposé que <span class="math inline">\(\alpha = \alpha_\star\)</span> : des deux termes ci-dessus, ne reste que le premier, à savoir <span class="math inline">\(\beta_\star - \beta\)</span>, qui est bien négatif comme demandé.</p>
</div>
</section>
<section id="un-exemple-de-test-de-rapport-de-vraisemblance" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="un-exemple-de-test-de-rapport-de-vraisemblance"><span class="header-section-number">7.4</span> Un exemple de test de rapport de vraisemblance</h2>
<p>Plaçons-nous dans un modèle de Bernoulli :&nbsp;on a des variables aléatoires <span class="math inline">\(X_1, \dotsc, X_n\)</span> iid de loi <span class="math inline">\(\mathrm{Ber}(p)\)</span>, et l’on souhaite tester une valeur <span class="math inline">\(p_0\)</span> de <span class="math inline">\(p\)</span> contre une valeur <span class="math inline">\(p_1 \neq p_0\)</span> à partir d’une réalisation <span class="math inline">\(x_1, \dotsc, x_n\)</span> du modèle.</p>
<p>Ici, les lois sont discrètes :&nbsp;elles possèdent une densité par rapport à la mesure de comptage. La probabilité d’observer <span class="math inline">\(x_1, \dotsc, x_n\)</span> dans le modèle avec paramètre <span class="math inline">\(p\)</span> est égale à <span class="math display">\[\prod_{i=1}^n p^{x_i}(1-p)^{1-x_i} = p^s(1-p)^{n-s}\]</span> où <span class="math inline">\(s = x_1 + \dotsc + x_n\)</span>. Ainsi, le rapport des vraisemblances <span class="math inline">\(r\)</span> est égal à <span class="math display">\[\frac{p_1^s (1-p_1)^{n-s}}{p_0^s(1-p_0)^{n-s}} = \left(\frac{p_1(1-p_0)}{p_0(1-p_1)}\right)^s\left(\frac{1-p_1}{1-p_0}\right)^n. \]</span> Le théorème de Neyman-Pearson dit qu’un test de la forme <span class="math inline">\(r&gt;z\)</span> est plus puissant que tous les tests ayant le même niveau. Or, cette région de rejet peut encore s’écrire <span class="math display">\[ s \ln \left(\frac{p_1(1-p_0)}{p_0(1-p_1)}\right) &gt; \ln(z) - n\ln\left(\frac{1-p_1}{1-p_0}\right).\]</span></p>
<p><strong>Dans le cas où <span class="math inline">\(p_0&lt;p_1\)</span></strong>, alors par croissance <span class="math inline">\(p_1 / (1-p_1)\)</span> est plus grand que <span class="math inline">\(p_0/(1-p_0)\)</span>, et donc cette région de rejet peut encore s’écrire <span class="math display">\[ \frac{s}{n} &gt; \frac{\ln(z)/n - \ln((1-p_1)/(1-p_0))}{\ln \left(\frac{p_1(1-p_0)}{p_0(1-p_1)}\right) }.\]</span> Cette écriture n’a rien d’intéressant en soi. Tout ce qui compte, c’est que la région de rejet <em>optimale au sens de Neyman-Pearson</em> est de la forme <span class="math inline">\(\{\bar{X}_n &gt; z'\}\)</span> où <span class="math inline">\(z'\)</span> correspond au terme de droite ci-dessus.</p>
<p><strong>Dans le cas où <span class="math inline">\(p_0&gt;p_1\)</span></strong>, alors le même raisonnement donne une région de rejet de la forme <span class="math inline">\(\{\bar{X}_n &lt; z'\}\)</span>.</p>
<p>La détermination de <span class="math inline">\(z'\)</span> dépendra du niveau de confiance que l’on veut se donner. L’erreur de première espèce est <span class="math inline">\(P_{p_0}(\bar{X}_n &gt; z')\)</span>, qui est la probabilité qu’une binomiale <span class="math inline">\(\mathrm{Bin}(n,p_0)\)</span> soit plus grande que <span class="math inline">\(nz'\)</span>. En choisissant pour <span class="math inline">\(nz'\)</span> le quantile de niveau <span class="math inline">\(1-\alpha\)</span> de cette loi, la probabilité ci-dessus est plus petite que <span class="math inline">\(\alpha\)</span> et le test est de niveau de confiance supérieur à <span class="math inline">\(1-\alpha\)</span>.</p>
</section>
<section id="variation-totale-et-distance-informationnelle" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="variation-totale-et-distance-informationnelle"><span class="header-section-number">7.5</span> Variation totale et distance informationnelle</h2>
<p><em>Ce chapitre n’a pas été vu en cours et n’est pas au programme.</em></p>
<p>La construction du test optimal au sens de l’affinité nécessite le calcul de la distance en variation totale, laquelle peut être notoirement difficile :</p>
<ul>
<li>d’abord, parce que la formule <a href="#eq-dtvformule" class="quarto-xref">Équation&nbsp;<span>7.1</span></a> peut être impossible à calculer même si <span class="math inline">\(P\)</span> et <span class="math inline">\(Q\)</span> sont connues ;</li>
<li>ensuite, parce que <span class="math inline">\(Q\)</span> elle-même peut parfois être très difficile à calculer (le calcul peut être de complexité exponentielle).</li>
</ul>
<p>En pratique, on peut chercher à <em>borner</em> cette distance par d’autres quantités plus faciles à calculer. Parmi ces quantités, la <em>divergence de Kullback-Leibler</em> joue un rôle extrêmement important, notamment pour son lien avec l’entropie et maximum de vraisemblance que nous verrons plus tard.</p>
<div id="def-dkl" class="theorem definition">
<p><span class="theorem-title"><strong>Définition 7.3</strong></span> Soient <span class="math inline">\(P\)</span> et <span class="math inline">\(Q\)</span> deux mesures, <span class="math inline">\(P\)</span> étant absolument continue par rapport à <span class="math inline">\(Q\)</span>. Alors,</p>
<p><span class="math display">\[ \dkl(P \mid Q) = \int \ln \left(\frac{\mathrm{d}P}{\mathrm{d}Q}\right)dP. \]</span></p>
<p>Si <span class="math inline">\(P\)</span> n’est pas absolument continue par rapport à <span class="math inline">\(Q\)</span>, on pose simplement <span class="math inline">\(\dkl(P \mid Q) = +\infty\)</span>.</p>
</div>
<p>La notation <span class="math inline">\(\mathrm{d}P/\mathrm{d}Q\)</span> désigne la densité de <span class="math inline">\(P\)</span> par rapport à <span class="math inline">\(Q\)</span>. Formellement, c’est la dérivée de Radon-Nikodym. Dans le cas de variables aléatoires continues sur <span class="math inline">\(\mathbb{R}^d\)</span>, c’est le rapport des densités de <span class="math inline">\(P\)</span> et de <span class="math inline">\(Q\)</span>.</p>
<p>La divergence <span class="math inline">\(\dkl\)</span> n’est pas une distance, et c’est pour cela qu’on l’appelle <em>divergence</em> et qu’on la note avec une barre plutôt qu’une virgule :&nbsp;elle n’est pas symétrique en général. Cependant, elle est toujours positive (éventuellement égale à <span class="math inline">\(+\infty\)</span> même si <span class="math inline">\(P\ll Q\)</span>), et n’est nulle que si <span class="math inline">\(P=Q\)</span>.</p>
<div id="thm-BH" class="theorem">
<p><span class="theorem-title"><strong>Théorème 7.3 (Borne de Bretagnole-Huber-Pinsker)</strong></span> <span id="eq-bh"><span class="math display">\[ \dtv(P,Q) \leqslant \sqrt{1 - e^{-\dkl(P \mid Q)}}. \tag{7.4}\]</span></span></p>
</div>
<p><span class="math display">\[~~\]</span></p>
<p><strong>Remarque.</strong> Il est facile de vérifier que <span class="math inline">\(\sqrt{1-e^{-x}}\leqslant \sqrt{x}\)</span> lorsque <span class="math inline">\(x&gt;0\)</span>. Ainsi, <a href="#eq-bh" class="quarto-xref">Équation&nbsp;<span>7.4</span></a> entraîne la borne plus simple <span class="math inline">\(\dtv \leqslant \sqrt{\dkl}\)</span>. La borne <em>classique</em> de Pinsker améliore légèrement ce résultat, puisqu’elle dit que <span class="math inline">\(\dtv \leqslant \sqrt{\dkl/2}\)</span>.</p>
<div class="proof">
<p><span class="proof-title"><em>Preuve</em>. </span>Si <span class="math inline">\(P\)</span> n’est pas absolument continue par rapport à <span class="math inline">\(Q\)</span>, alors <span class="math inline">\(\dkl(P \mid Q)=+\infty\)</span> et la borne demandée est vraie. Sinon, on note <span class="math inline">\(\rho\)</span> la densité de <span class="math inline">\(P\)</span> par rapport à <span class="math inline">\(Q\)</span>, de sorte que <span class="math inline">\(\dkl(P\mid Q) = -\int \ln \rho(x) \mathrm{d}P\)</span>. On définit ensuite <span class="math inline">\(v = (\rho-1)_+\)</span> et <span class="math inline">\(w = (\rho-1)_-\)</span>, de sorte que <span class="math inline">\(vw\)</span> vaut toujours 0, et donc <span class="math inline">\((1 + v)(1-w) = 1 - w + v = \rho\)</span>. En particulier, <span class="math inline">\(\dkl(P\mid Q)\)</span> vaut <span class="math display">\[\int(-\ln(1+v))dP + \int (-\ln(1-w))dP.\]</span> Or, les deux fonctions <span class="math inline">\(x\mapsto -\ln(1+x)\)</span> et <span class="math inline">\(x\mapsto -\ln(1-x)\)</span> sont concaves sur leurs ensembles de définition. Ainsi, l’inégalité de Jensen entraîne d’une part <span class="math display">\[ \int(-\ln(1+v))\mathrm{d}P \leqslant - \ln \left(1 + \int v \mathrm{d}P\right)\]</span> et d’autre part <span class="math display">\[ \int(-\ln(1-w))\mathrm{d}P \leqslant - \ln \left(1 - \int w \mathrm{d}P\right).\]</span> Or, la formule <a href="#eq-dtvformule" class="quarto-xref">Équation&nbsp;<span>7.1</span></a> montre que <span class="math inline">\(\int v\mathrm{d}P =  \dtv(P,Q)\)</span>, et de même pour <span class="math inline">\(\int w \mathrm{d}P\)</span>. En additionnant les deux inégalités ci-dessus, on obtient Alors <span class="math display">\[-\dkl \leqslant - \ln \left((1 + \dtv)(1 - \dtv\right)\]</span> soit <span class="math inline">\(-\dkl \leqslant -\ln(1 - \dtv^2)\)</span>, c’est-à-dire <a href="#eq-bh" class="quarto-xref">Équation&nbsp;<span>7.4</span></a>.</p>
</div>
<p>On peut se demander s’il existe une inégalité dans l’autre sens, permettant de borner la distance KL par quelque chose qui dépend de la distance en variation totale. La réponse est oui, et dépend d’une quantité importante en théorie de l’information, la <em>varentropie</em>.</p>
<div id="def-varentropie" class="theorem definition">
<p><span class="theorem-title"><strong>Définition 7.4</strong></span> La varentropie de <span class="math inline">\(Q\)</span> par rapport à <span class="math inline">\(P\)</span> est la variance de <span class="math inline">\(\ln(\mathrm{d}P/\mathrm{d}Q)\)</span> par rapport à <span class="math inline">\(P\)</span> : &nbsp; <span class="math display">\[\mathrm{Varent}(P | Q) = \int \ln\left(\frac{\mathrm{d}P}{\mathrm{d}Q}\right)^2 dP - \left( \int \ln\left(\frac{\mathrm{d}P}{\mathrm{d}Q}\right)dP\right)^2.\]</span></p>
</div>
<p>La varentropie mesure à quel point l’information est concentrée autour de l’entropie.</p>
<div id="thm-reversepinsker" class="theorem">
<p><span class="theorem-title"><strong>Théorème 7.4 (Borne entropique inférieure)</strong></span> <span class="math display">\[ \dkl(P\mid Q) \leqslant \frac{1 + \sqrt{\mathrm{Varent(P\mid Q)}}}{1 - \dtv(P,Q)}\]</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Preuve</em>. </span>Introduisons l’événement <span class="math inline">\(E = \{x :&nbsp;P(x) \geqslant Q(x)e^{d}\}\)</span> où <span class="math inline">\(d = \dkl - \sqrt{\mathrm{Varent}} / (1-\dtv)\)</span>. Il est clair que <span class="math display">\[P(E)\geqslant e^d Q(E).\]</span> L’espérance sous <span class="math inline">\(P\)</span> de la variable aléatoire <span class="math inline">\(X = \ln \mathrm{d}P / \mathrm{d}Q\)</span> est <span class="math inline">\(\dkl\)</span>, et sa variance est <span class="math inline">\(\mathrm{Varent}\)</span> ; le complémentaire de <span class="math inline">\(E\)</span> est <span class="math inline">\(\{X &lt; d\} = \{X - \dkl &lt; -\sqrt{\mathrm{Varent}}/(1-\dtv)\}\)</span>, donc l’inégalité de Bienaymé-Tchebychev dit que <span class="math display">\[P(\bar{E}) \leqslant (1-\dtv)^2.\]</span> En combinant les deux inégalités, on voit que <span class="math display">\[P(E) - Q(E) \geqslant (1 - (1 - \dtv)^2)(1-e^{-d}).\]</span> Or, le membre de gauche est lui-même plus petit que <span class="math inline">\(\dtv\)</span>. Par conséquent, <span class="math display">\[ \dtv \geqslant (1 - (1 - \dtv)^2)(1 - e^{-d}).\]</span> Il est très simple de réarranger les termes de cette inégalité, pour finalement trouver qu’elle est équivalente à <span class="math display">\[e^d \leqslant 1 + \frac{1}{1 - \dtv}.\]</span> En revenant à la définition de <span class="math inline">\(d\)</span> et en utilisant <span class="math inline">\(\ln(1+x)\leqslant x\)</span>, on voit immédiatement que <span class="math display">\[\dkl \leqslant \frac{1}{1 - \dtv} + \frac{\sqrt{\mathrm{Varent}}}{1 - \dtv}\]</span> ce qui est l’inégalité demandée.</p>
</div>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Si <span class="math inline">\(P\)</span> est <a href="https://fr.wikipedia.org/wiki/Th%C3%A9or%C3%A8me_de_Radon-Nikodym-Lebesgue">absolument continue</a> par rapport à <span class="math inline">\(Q\)</span> (ce qu’on note <span class="math inline">\(P \ll Q\)</span>), alors la dérivée de Radon-Nikodym existe, et c’est une fonction mesurable positive <span class="math inline">\(f\)</span> (unique à un ensemble <span class="math inline">\(Q\)</span>-négligeable près) qui vérifie <span class="math inline">\(P(A) = \int f(x)\mathbf{1}_{x\in A}\mathrm{d}Q\)</span>. On appelle cette fonction <em>densité</em> de <span class="math inline">\(P\)</span> par rapport à <span class="math inline">\(Q\)</span>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copié");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copié");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../content/ch4_0.html" class="pagination-link" aria-label="Test d'hypothèses">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Test d’hypothèses</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../content/ch4_2.html" class="pagination-link" aria-label="Tests du $\chi_2$">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Tests du <span class="math inline">\(\chi_2\)</span></span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>