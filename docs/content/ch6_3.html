<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.30">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>16&nbsp; Entropie et information – Statistiques Fondamentales</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../content/ch6_4.html" rel="next">
<link href="../content/ch6_ex.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-de070a7b0ab54f8780927367ac907214.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-83a5b8d58647c924f663c9ce3a35b344.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer",
    "search-label": "Recherche"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../utils/styles.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../content/ch6_3.html"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Entropie et information</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Recherche" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Statistiques Fondamentales</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/statsfonda/site" title="Code source" class="quarto-navigation-tool px-1" aria-label="Code source"><i class="bi bi-github"></i></a>
    <a href="../Statistiques-Fondamentales.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Recherche"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Organisation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Estimation de paramètre</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch2_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">La méthode des moments</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch2_ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercices</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Intervalles de confiance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch31_outils.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Outils pour les Intervalles de Confiance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch3_ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercices</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch4_0.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Test d’hypothèses</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch4_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Théorie des tests simples</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch4_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Tests du <span class="math inline">\(\chi_2\)</span></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch4_ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercices</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch5_0.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Moindres carrés</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch5_01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Modèles linéaires</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch5_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Outils gaussiens</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch5_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Tests linéaires</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch5_ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercices</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch6_0.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Modèles exponentiels</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch6_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Maximum de vraisemblance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch6_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">L’information de Fisher</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch6_ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercices</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch6_3.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Entropie et information</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch6_4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Principe d’entropie maximale</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/problemes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Problèmes et sujets</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch7_0.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Estimation de densité</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch7_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Test de Kolmogorov-Smirnov</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch7_ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercices</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ch8_0.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Fisher VS Bayes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Et après ?</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/ref.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Références</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/app1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Algèbre linéaire</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/app3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Formules d’inversion</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/app2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">50&nbsp;nuances de TCL</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table des matières</h2>
   
  <ul>
  <li><a href="#la-notion-de-code" id="toc-la-notion-de-code" class="nav-link active" data-scroll-target="#la-notion-de-code"><span class="header-section-number">16.1</span> La notion de code</a></li>
  <li><a href="#le-théorème-de-shannon" id="toc-le-théorème-de-shannon" class="nav-link" data-scroll-target="#le-théorème-de-shannon"><span class="header-section-number">16.2</span> Le théorème de Shannon</a></li>
  <li><a href="#lentropie-relative" id="toc-lentropie-relative" class="nav-link" data-scroll-target="#lentropie-relative"><span class="header-section-number">16.3</span> L’entropie relative</a></li>
  <li><a href="#information-de-fisher-et-entropie" id="toc-information-de-fisher-et-entropie" class="nav-link" data-scroll-target="#information-de-fisher-et-entropie"><span class="header-section-number">16.4</span> Information de Fisher et entropie</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">
<div style="display:&nbsp;none;"><p style="display: none;">
$$
\newcommand{\bx}{\boldsymbol{x}}
\newcommand{\bt}{\boldsymbol{\theta}}
\newcommand{\bmu}{\boldsymbol{\mu}}
\newcommand{\dkl}{\mathrm{d}_{\mathrm{KL}}}
\newcommand{\dtv}{\mathrm{d}_{\mathrm{TV}}}
\newcommand{\emv}{\hat{\theta}_{\mathrm{emv}}}
\newcommand{\ent}{\mathrm{Ent}}
$$
</p></div>


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Entropie et information</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Soient <span class="math inline">\(X_i\)</span> des variables aléatoires définies sur un même ensemble fini <span class="math inline">\(\mathcal{X} = (a_1, \dotsc, a_k)\)</span>. On note <span class="math inline">\(p_k = \mathbb{P}(X = a_k)\)</span>. On observe un échantillon de <span class="math inline">\(n\)</span> réalisations des <span class="math inline">\(X_i\)</span>, disons <span class="math inline">\((x_1, \dotsc, x_n)\)</span>. Avant de s’intéresser à l’information que portent ces observations sur la loi <span class="math inline">\(\mathbb{P}\)</span>, qui est le problème <em>statistique</em> auquel nous nous sommes intéressé, on peut se demander quelle est la quantité d’information portée par les <span class="math inline">\(x_i\)</span> <em>tout court</em>, sans avoir à faire d’hypothèses sur la loi de <span class="math inline">\(X\)</span>. Par exemple, si toutes les observations sont identiques, l’échantillon transporte peu d’information – en tout cas, moins que si les observations sont un peu plus variées. La question posée est la suivante :&nbsp;si l’on voulait coder les observations de sorte que deux observations différentes soient codées de deux façons différentes, et de sorte qu’en moyenne le codage des informations soit le plus compressé possible, quel code utiliserait-on ?</p>
<section id="la-notion-de-code" class="level2" data-number="16.1">
<h2 data-number="16.1" class="anchored" data-anchor-id="la-notion-de-code"><span class="header-section-number">16.1</span> La notion de code</h2>
<p>Il faut raisonner en termes de bits d’information :&nbsp;on veut coder chaque élément observé par une suite de 0 et de 1.</p>
<p>Par exemple, supposons que <span class="math inline">\(\mathcal{X}\)</span> ne possède que deux éléments ; on peut coder <span class="math inline">\(x_i=0\)</span> ou <span class="math inline">\(1\)</span> et voir notre échantillon comme une suite binaire de longueur <span class="math inline">\(n\)</span>. On aura donc besoin de au plus <span class="math inline">\(n\)</span> bits d’information pour encoder l’échantillon ;&nbsp;un « bit » est la donnée d’un 0 ou d’un 1.</p>
<p>Si maintenant <span class="math inline">\(\mathcal{X}\)</span> contient 4 éléments, on peut coder ses élements par des suites de deux bits :&nbsp;<span class="math inline">\(00,01,10, 11\)</span>. Le codage d’une observation nécessitera toujours deux bits. Pour encoder notre échantillon, on aura besoin de <span class="math inline">\(n\)</span> fois deux bits d’information au plus, donc <span class="math inline">\(2n\)</span> bits. Par exemple, l’échantillon <span class="math inline">\((a,a,a,b,a,d,d,a,a,a)\)</span> sera codé <span class="math inline">\(00000001001111000000\)</span>, donc 20 bits.</p>
<p>Plus généralement, si <span class="math inline">\(\mathcal{X}\)</span> contient <span class="math inline">\(k\)</span> éléments, on peut chacun les coder avec au plus <span class="math inline">\(\log_2\lceil k \rceil\)</span> bits et il faudra <span class="math inline">\(n\log_2\lceil k \rceil\)</span> pour encoder l’échantillon.</p>
<p>Dans ces exemples, chaque codage d’un échantillon nécessitait le même nombre de bits. Ce codage-là ne nécessite aucune information particulière sur les <span class="math inline">\(x_i\)</span>. Mais maintenant, dans le cas où <span class="math inline">\(\mathcal{X}\)</span> comporte 4 éléments <span class="math inline">\(\{a,b,c,d\}\)</span>, supposons que le premier élément soit beaucoup plus fréquent que les autres ; autrement dit,</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th style="text-align: center;">a</th>
<th style="text-align: center;">b</th>
<th style="text-align: center;">c</th>
<th style="text-align: center;">d</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\mathbb{P}(X = …)\)</span></td>
<td style="text-align: center;">97%</td>
<td style="text-align: center;">1%</td>
<td style="text-align: center;">1%</td>
<td style="text-align: center;">1%</td>
</tr>
</tbody>
</table>
<p>Dans ce cas, la plupart des observations n’auront que des <span class="math inline">\(a\)</span>. Donc si j’assigne à l’observation <span class="math inline">\(a\)</span> un code <em>d’un seul bit</em>, disons 0, et que j’assigne aux trois autres des codes plus longs comme <span class="math inline">\(10, 110, 111\)</span>, alors le coût moyen de codage d’une observation sera <span class="math display">\[ 1\times 97\% + 2\times 1\% + 3 \times 1\% + 3\times 1\% = 1.05\]</span> Autrement dit, en moyenne, je n’aurai pas besoin de beaucoup plus d’un bit d’observation par observation, alors que le codage élémentaire ci-dessus en nécessitait exactement deux. Avec ce code, l’échantillon <span class="math inline">\((a,a,a,b,a,d,d,a,a,a)\)</span> devient codé par <span class="math inline">\(000100111111000\)</span>, donc 15 bits.</p>
<div id="def-code" class="theorem definition">
<p><span class="theorem-title"><strong>Définition 16.1</strong></span> Un <em>code binaire</em> de <span class="math inline">\(\mathcal{X}\)</span> assigne à chaque élément <span class="math inline">\(a\)</span> de <span class="math inline">\(\mathcal{X}\)</span> un mot binaire <span class="math inline">\(w(a)\)</span>. Le code d’un élément ne doit pas être le début du code d’un autre élément.</p>
</div>
<p>Par exemple, je n’ai pas le droit de coder l’ensemble à quatre éléments avec le code <span class="math inline">\(w(1)=1, w(2)=10, w(3)=11, w(4)=010\)</span>. En effet, dans ce cas je ne serai pas en mesure de discerner si <span class="math inline">\(1010\)</span> veut dire <span class="math inline">\(w(1)w(4)\)</span> ou bien <span class="math inline">\(w(2)w(2)\)</span>.</p>
<p>La longueur du <span class="math inline">\(k\)</span>-ème élément <span class="math inline">\(w(k)\)</span> est notée <span class="math inline">\(\ell_k\)</span>. Étant donné un code, le nombre moyen de bits d’information nécessaire pour coder une variable aléatoire <span class="math inline">\(X\)</span> sur <span class="math inline">\(\mathcal{X}\)</span> est donc <span class="math display">\[\mathbb{E}[\ell_X] = \sum_{i=1}^k \ell_i \mathbb{P}(X = a_i).\]</span></p>
<div id="exm-codage" class="theorem example">
<p><span class="theorem-title"><strong>Exemple 16.1</strong></span> Un roman contient environ 80000 mots, donc environ 400000 signes (en comptant les espaces). Un signe peut être l’une des 26 lettres de l’alphabet (en majuscule ou minuscule), un signe de ponctuation, un chiffre, une lettre accentuée… La plupart des romans occidentaux ont besoin d’un alphabet de ~200 lettres. Le codage binaire basique lettre-par-lettre nécessiterait donc environ <span class="math inline">\(\lceil \log_2 200 \rceil \approx 8\)</span> bits d’information par lettre, soit 3200000 bits. On compte plutôt en paquet de 8 bits, appelés bytes :&nbsp;le codage du roman nécessiterait donc environ 400000 bytes soit 400kB.</p>
</div>
</section>
<section id="le-théorème-de-shannon" class="level2" data-number="16.2">
<h2 data-number="16.2" class="anchored" data-anchor-id="le-théorème-de-shannon"><span class="header-section-number">16.2</span> Le théorème de Shannon</h2>
<p>Quel est la plus petite quantité moyenne d’informations nécessaire à coder une réalisation de <span class="math inline">\(X\)</span> ? La réponse est <em>l’entropie de la loi de <span class="math inline">\(P\)</span></em>.</p>
<div id="def-entropie" class="theorem definition">
<p><span class="theorem-title"><strong>Définition 16.2 (Entropie)</strong></span> Soit <span class="math inline">\(X\)</span> une variable aléatoire de loi <span class="math inline">\(P\)</span>, possédant une densité <span class="math inline">\(f\)</span> par rapport à une mesure de référence. L’entropie <span class="math inline">\(\ent(P)\)</span> est <span class="math display">\[ - \int_{\mathcal{X}}f(x)\log_2 f(x)\nu(dx).\]</span></p>
</div>
<p>Lorsque <span class="math inline">\(X\)</span> est une variable discrète prenant la valeur <span class="math inline">\(a_k\)</span> avec probabilité <span class="math inline">\(p_k\)</span>, l’entropie est donc égale à <span class="math display">\[ -\sum_{k} p_k \log_2 p_k.\]</span></p>
<p>En théorie de l’information, on prend plutôt le logarithme en base 2 plutôt que le logarithme népérien. L’entropie ne diffère alors que d’une constante <span class="math inline">\(\ln(2)\)</span>.</p>
<p>Le théorème de codage suivant ne s’applique qu’aux variables discrètes.</p>
<div id="thm-shannon" class="theorem">
<p><span class="theorem-title"><strong>Théorème 16.1 (Théorème de codage de Shannon)</strong></span> Tout codage vérifie <span class="math inline">\(\mathbb{E}[\ell_X]\geqslant \ent(P)\)</span>.</p>
<p>Il existe un codage appelé <em>codage entropique</em> vérifiant <span class="math inline">\(\ell^\star(a)=\lceil \log_2(p_k)\rceil\)</span>, et donc <span class="math inline">\(\mathbb{E}[\ell^\star_X]\leqslant \ent(P)+1\)</span>.</p>
</div>
<p>En particulier, le codage optimal d’un échantillon iid de taille <span class="math inline">\(n\)</span> vérifie <span class="math display">\[ \lim \frac{\mathbb{E}[\ell^\star_n]}{n} = \ent(P).\]</span></p>
<p>L’entropie d’une loi est donc en le nombre moyen de bits d’information nécessaire à son codage le plus économe : asymptotiquement,&nbsp;ce codage est le <em>codage entropique</em> qui assigne à chaque <span class="math inline">\(a \in \mathcal{X}\)</span> un code de longueur proche de <span class="math inline">\(\log_2(\mathbb{P}(X=a))\)</span>. Cependant, il existe d’autres codages qui sont asymptotiquement meilleurs que le codage ci-dessus, et qui sont meilleurs même à distance finie :&nbsp;par exemple, le codage de Huffman.</p>
<div class="proof">
<p><span class="proof-title"><em>Preuve</em>. </span>On énumère les <span class="math inline">\(n&gt;2\)</span> éléments de <span class="math inline">\(\mathcal{X}\)</span> en <span class="math inline">\(a_1, \dotsc, a_n\)</span>, et on note <span class="math inline">\(p_i = P(X = a_i)\)</span>. Soit <span class="math inline">\(\ell\)</span> un codage et soit <span class="math inline">\(\ell_i\)</span> la longueur du code <span class="math inline">\(\ell(a_i)\)</span>. La longueur moyenne de ce code est <span class="math display">\[ E[\ell_X] = \sum_{i=1}^n p_i\ell_i.\]</span></p>
</div>
<p>Ainsi, <span class="math inline">\(E[\ell_X] - \ent(P)\)</span> vaut <span class="math display">\[\sum_{i=1}^n p_i\left(\ell_i + \log_2(p_i)\right)\]</span> c’est-à-dire, après une petite manipulation, <span class="math display">\[-\sum_{i=1}^n p_i\log_2\left(\frac{1}{p_i2^{\ell_i}}\right).\]</span> La fonction <span class="math inline">\(-\log_2\)</span> étant convexe, l’inégalité de Jensen dit que la quantité ci-dessus est plus grande que <span class="math display">\[ -\log_2 \left( \sum_{i=1}^n p_i\frac{1}{p_i 2^{\ell_i}} \right)\]</span> qui se simplifie en <span class="math display">\[ -\log_2 \left( \sum_{i=1}^n \frac{1}{2^{\ell_i}} \right).\]</span> Il suffit alors de montrer que la somme <span class="math inline">\(s\)</span> à l’intérieur du <span class="math inline">\(\log_2\)</span> est plus petite que 1 : c’est cette inégalité qui est connue sous le nom de <em>lemme de Kraft</em>. Elle entraîne immédiatement que <span class="math inline">\(-\log_2(s) \geqslant 0\)</span>, et donc <span class="math inline">\(E[\ell_X] \geqslant \ent(P)\)</span>.</p>
<p><strong>Démonstration du lemme de Kraft.</strong> Mettons la constante <span class="math inline">\(s\)</span> à une puissance entière <span class="math inline">\(k\)</span> :&nbsp;en écrivant <span class="math inline">\(s^k\)</span> comme <span class="math display">\[\left(\sum_{a \in \mathcal{X}}\frac{1}{2^{\ell(a)}} \right)^k\]</span> et en développant, on trouve <span class="math display">\[\sum_{a^1, \dotsc, a^k \in \mathcal{X}}\frac{1}{2^{\ell(a^1) + \dotsb + \ell(a^k)}}\]</span> c’est-à-dire <span class="math display">\[\sum_{A \in \mathcal{X}^k}\frac{1}{2^{\ell(A)}}.\]</span> Notons <span class="math inline">\(c_i\)</span> le nombre de mots de <span class="math inline">\(k\)</span> lettres dont le code est lui-même de longueur <span class="math inline">\(i\)</span>. La quantité précédente vaut <span class="math display">\[\sum_{i=1}^{+\infty} c_i \frac{1}{2^i}.\]</span> Vu que le code est injectif, deux mots différents ont deux codes différents : or, il y a <span class="math inline">\(2^i\)</span> codes possibles de longueur <span class="math inline">\(i\)</span>, donc <span class="math inline">\(c_i \leqslant 2^i\)</span>. De plus, si <span class="math inline">\(N\)</span> est la longueur de la lettre la plus longue à coder, il est clair que le mot le plus long à coder aura une longueur de <span class="math inline">\(kN\)</span>. Ainsi, <span class="math inline">\(c_i\)</span> devient nul dès que <span class="math inline">\(i&gt;kN\)</span>. On en déduit que la somme ci-dessus est plus petite que <span class="math display">\[\sum_{i=1}^{kN} 2^i \frac{1}{2^i} = kN.\]</span> On vient de montrer que, pour n’importe quel nombre entier <span class="math inline">\(k\)</span> non nul, <span class="math display">\[s^k \leqslant kN.\]</span> Si le nombre <span class="math inline">\(s\)</span> était strictement plus grand que 1, le terme de droite aurait une croissance exponentielle en <span class="math inline">\(k\)</span>, tandis que le terme de gauche n’aurait qu’une croissance linéaire. C’est impossible, et on doit donc avoir <span class="math inline">\(s\leqslant 1\)</span>.</p>
</section>
<section id="lentropie-relative" class="level2" data-number="16.3">
<h2 data-number="16.3" class="anchored" data-anchor-id="lentropie-relative"><span class="header-section-number">16.3</span> L’entropie relative</h2>
<p>Soit <span class="math inline">\(P\)</span> une loi de probabilité. Le codage optimal de <span class="math inline">\(P\)</span> est <span class="math inline">\(\log_2 P\)</span>. On pourrait aussi utiliser le codage d’une autre loi de probabilité, disons <span class="math inline">\(Q\)</span> :&nbsp; la quantité</p>
<p><span class="math display">\[\sum_{k=1}^n p_k \log_2\frac{p_k}{q_k}\]</span> peut aussi se voir comme <span class="math display">\[E[\log_2 q_X] - E[\ell_X^\star].\]</span> Il s’agit donc bien d’une « redondance d’information » :&nbsp;le terme de droite est la quantité minimale d’information dont on a besoin pour coder <span class="math inline">\(X\)</span> en moyenne (via le codage entropique), et le terme de gauche est la quantité d’information dont on use pour coder <span class="math inline">\(X\)</span> en moyenne par le code <span class="math inline">\(S\)</span>. À une constante près<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, la divergence de Kullback-Leibler <span class="math display">\[ \dkl(P\mid Q) =  - \int P \ln Q - \left( - \int P \ln P \right)\]</span> indique donc à quel point il est optimal (ou pas) d’encoder les réalisations de la loi <span class="math inline">\(P\)</span> grâce au « code » <span class="math inline">\(\log_2 Q\)</span> : <span class="math inline">\(\dkl\)</span> quantifie la <em>redondance</em> de <span class="math inline">\(Q\)</span> par rapport à <span class="math inline">\(P\)</span>.&nbsp;Puisque le codage optimal est celui qui code <span class="math inline">\(x\)</span> par <span class="math inline">\(\log_2 P(x)\)</span>, le codage utilisant <span class="math inline">\(\log_2 Q(x)\)</span> n’a pas structuré au mieux l’information disponible dans <span class="math inline">\(P\)</span> est pourrait être allégé.</p>
</section>
<section id="information-de-fisher-et-entropie" class="level2" data-number="16.4">
<h2 data-number="16.4" class="anchored" data-anchor-id="information-de-fisher-et-entropie"><span class="header-section-number">16.4</span> Information de Fisher et entropie</h2>
<p>Dans le cas général d’une loi de densité <span class="math inline">\(f\)</span> par rapport à une mesure de référence <span class="math inline">\(\nu\)</span>, l’entropie est donnée par</p>
<div id="def-entropie-generale" class="theorem definition">
<p><span class="theorem-title"><strong>Définition 16.3 (Entropie)</strong></span> L’entropie d’une loi de densité <span class="math inline">\(f\)</span> par rapport à la mesure de référence <span class="math inline">\(\nu\)</span> est donnée par <span class="math display">\[\mathrm{Ent}(f) = -\int f(x)\ln f(x)\nu(dx). \]</span></p>
</div>
<p>Lorsque <span class="math inline">\(\nu\)</span> est la mesure de comptage sur un ensemble fini ou discret <span class="math inline">\(\mathcal{X}\)</span>, on retrouve la formule de l’entropie discrète ci-dessus.</p>
<p>Dans le cas d’un modèle exponentiel, l’entropie est égale à <span class="math inline">\(E_\theta[\ln p_\theta(X)]\)</span> par définition. On peut interpréter <span class="math inline">\(I(\theta)\)</span> comme la <em>courbure moyenne de l’entropie</em>.</p>
<div id="prp-courbure" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 16.1</strong></span> <span class="math inline">\(I(\theta) = - \nabla^2_\theta~ \mathrm{Ent}(p_\theta).\)</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Preuve</em>. </span>Il suffit de dériver deux fois sous l’intégrale et d’utiliser <a href="ch6_0.html#eq-hess-exp" class="quarto-xref">Équation&nbsp;<span>13.2</span></a>.</p>
</div>
<p>Comme dans ce cadre, l’entropie est concave, la courbure en <span class="math inline">\(\theta\)</span> est un indicateur de à quel point l’entropie forme un « pic » autour de <span class="math inline">\(\theta\)</span>.</p>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>À savoir <span class="math inline">\(\ln(2)\)</span>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copié");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copié");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../content/ch6_ex.html" class="pagination-link" aria-label="Exercices">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Exercices</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../content/ch6_4.html" class="pagination-link" aria-label="Principe d'entropie maximale">
        <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Principe d’entropie maximale</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>